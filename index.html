<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>log-shuttle</title>
	<meta name="author" content="Heroku">
	<meta name="description" content="log-shuttle" />
	<link href='http://fonts.googleapis.com/css?family=Audiowide' rel='stylesheet' type='text/css'>


  <style>
    body {
      font-family: Helvetica, sans-serif;
      width: 60%;
      margin: auto;
    }
    h1 {
      font-size: 5em;
      font-family: 'Audiowide', cursive;
      margin-bottom: 0px;
    }
    h2 {
      font-size: 2em;
      font-family: 'Audiowide', cursive;
    }
    h3 {
      font-size: 1.5em;
      font-family: 'Audiowide', cursive;
    }
    p {
      font-size: 16px;
      line-height: 20px;
    }
    ul {
    }
    li {
      padding-bottom: 1em;
    }
    a {
      color:grey;
    }
  </style>
</head>

<body>
  <a href="https://github.com/heroku/log-shuttle"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>
	<h1>log shuttle</h1>
	<h2>Synopsis</h2>
  <p>Log-shuttle is an open source command line program that reads <a href="http://en.wikipedia.org/wiki/Line_feed">line feed</a> seperated ("\n") messages from stdin and delivers them to log processors via HTTPS.</p>
  <p>Log-shuttle batches logs, encoding the HTTP body in length prefixed <a href="http://tools.ietf.org/html/rfc5424">RFC5424</a> frames. Both <a href="https://github.com/heroku/logplex">logplex</a> and <a href="https://github.com/heroku/log-iss">log-iss</a> understand this format. This trio of programs handles nearly ~20 billion log lines a day at <a href="http://heroku.com">Heroku</a>.</p>
  <h2>Provides</h2>
  <ul>
    <li>HTTP(S) transport of logs</li>
    <li>When paired with a HTTP(S) load balancer like <a href="http://haproxy.1wt.eu/">haproxy</a> or <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon ELB</a>, good distribution of logs to backend receivers (e.g. indexers, log routers, etc).</li>
    <li>Gzip compression when supported by the receiver.</li>
    <li>HTTPS server cert validation.</li>
    <li>HTTP <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">basic auth</a>.</li>
    <li>Configurable batch size and timeouts to ensure timely delivery.</li>
    <li>Configurable number of HTTP outlets.</li>
    <li>Optional statistics about it's operation.</li>
  </ul>

	<h2>Quick Start</h2>
  <h3>From Source</h3>
  <p>Install a current version of <a href="http://golang.org/doc/install">Go</a>.</p>
    <pre><code>
$ go version
go version go1.2.1 darwin/amd64
$ git clone https://github.com/heroku/log-shuttle.git
$ go get github.com/tools/godep
$ cd log-shuttle
$ godep go build ./...
$ echo 'hello world' | ./log-shuttle -logs-url="https://east.logplex.io/logs"
    </code></pre>

  <h3>Linux Binary</h3>
  <pre><code>
$ curl -O https://log-shuttle-build.herokuapp.com/bin/log-shuttle
$ echo 'hello world' | ./log-shuttle -logs-url="https://east.logplex.io/logs"
  </code></pre>

  <h3>Linux Package</h3>
  <pre><code>
$ curl -O https://log-shuttle-build.herokuapp.com/log-shuttle_0.9.3_amd64.deb
$ dpkg -i log-shuttle_0.9.3_amd64.deb
$ echo 'hello world' | log-shuttle -logs-url="https://east.logplex.io/logs"
  </code></pre>

	<h2>Syslog-ng Integration</h2>
	<em>/etc/syslog-ng.conf</em>
	<pre><code>
source s_all {
	internal();
	unix-dgram("/dev/log");
	file("/proc/kmsg" program_override("kernel: "));
};
destination log_shuttle {
  program("/usr/bin/log-shuttle -skip-headers" flags(no_multi_line, syslog-protocol));
};

log {
  source(s_all);
  destination(log_shuttle);
};
	</code></pre>

	<h2>Tail Files</h2>
	<pre><code>
$ tail -qF -n 0 /var/log/* | ./log-shuttle
  </code></pre>

	<h2>Heroku Logplex</h2>
	<p>Checkout Heroku's <a href="https://devcenter.heroku.com/articles/add-on-provider-log-integration">Dev Center Article</a> for instructions on how to acquire an app's logplex token. Once you have the token, run the following command:</p>
	<pre><code>
$ ./log-shuttle -logplex-token="t.abc123" \
	-logs-url="https://east.logplex.io/logs" \
	-front-buff=500 \
	-batch-size=300
  </code></pre>
	
	<h2>Contact</h2>
	<p><a href="https://github.com/heroku/log-shuttle">Github</a></p>
</body>
</html>
